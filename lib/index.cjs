"use strict";var w=Object.create;var d=Object.defineProperty;var R=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var E=Object.getPrototypeOf,D=Object.prototype.hasOwnProperty;var A=(r,e)=>{for(var n in e)d(r,n,{get:e[n],enumerable:!0})},h=(r,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of N(e))!D.call(r,o)&&o!==n&&d(r,o,{get:()=>e[o],enumerable:!(t=R(e,o))||t.enumerable});return r};var T=(r,e,n)=>(n=r!=null?w(E(r)):{},h(e||!r||!r.__esModule?d(n,"default",{value:r,enumerable:!0}):n,r)),q=r=>h(d({},"__esModule",{value:!0}),r);var V={};A(V,{SentryLink:()=>p,default:()=>p,excludeGraphQLFetch:()=>b,withoutGraphQLFetch:()=>v});module.exports=q(V);var F=require("@apollo/client/errors"),S=require("@apollo/client/link/core"),k=T(require("zen-observable"),1);function u(r){return r.query.definitions.find(e=>e.kind==="OperationDefinition")}function B(r,e){let n=e.attachBreadcrumbs,t=u(r),o={},i=e.uri;i&&(o.url=i);let s=t.name?.value;return s&&(o.operationName=s),n.includeVariables&&(o.variables=r.variables),{type:"http",category:`graphql.${t.operation}`,data:o}}var O={shouldHandleOperation:void 0,uri:void 0,setSpan:!0,setFingerprint:!0,attachBreadcrumbs:{includeVariables:!1,includeError:!1,transform:void 0}};function y(r){return{...O,...r,attachBreadcrumbs:{...O.attachBreadcrumbs,...r.attachBreadcrumbs}}}var c=require("@sentry/browser");function x(r){let e={};for(let[n,t]of Object.entries(r))e[n]=typeof t=="object"?C(t):t;return e}function C(r){return JSON.stringify(r,null,2)}function g(r){let n=u(r).name;if(n){let o=(0,c.getCurrentHub)().getScope();if(!o)return;let i=o.getTransaction();return i?i.startChild({op:"apollo.request",description:"Apollo request: "+n.value}):void 0}}var j="{{ default }}";function L(r){let n=u(r).name;n&&(0,c.configureScope)(t=>{t.setFingerprint([j,n.value])})}function m(r,e,n){let t=n.attachBreadcrumbs&&typeof n.attachBreadcrumbs.transform=="function"?n.attachBreadcrumbs.transform(e,r):e;t.data=x(t.data),(0,c.addBreadcrumb)(t)}var p=class extends S.ApolloLink{options;constructor(e={}){super(),this.options=y(e)}request(e,n){let t=this.options;if(!(t.shouldHandleOperation?.(e)??!0))return n(e);let o;t.setSpan&&(o=g(e)),t.setFingerprint&&L(e);let i=t.attachBreadcrumbs,s=i?B(e,t):void 0;return new k.default(f=>{let G=n(e).subscribe({next:a=>{i&&(s.level=P(a),i.includeError&&a.errors&&a.errors.length>0&&(s.data.error=new F.ApolloError({graphQLErrors:a.errors}))),f.next(a)},complete:()=>{i&&m(e,s,t),t.setSpan&&o?.finish?.(),f.complete()},error:a=>{if(i){s.level="error";let l;if(H(a)){let{result:I,response:K,...Q}=a;l=Q}else l=a;i.includeError&&(s.data.error=l),m(e,s,t)}t.setSpan&&o?.finish?.(),f.error(a)}});return()=>{G.unsubscribe()}})}};function H(r){return typeof r=="object"&&r!==null&&"response"in r&&"result"in r&&"statusCode"in r}function P(r){return r.errors&&r.errors.length>0?"error":"info"}var b=r=>r.category==="fetch"&&(r.data?.url??"").includes("/ws.php")?null:r;function v(r){return(e,n)=>{let t=b(e,n);return t===null?null:r(t,n)}}
