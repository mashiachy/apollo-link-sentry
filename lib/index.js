"use strict";var Q=Object.create;var d=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var R=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,E=Object.prototype.hasOwnProperty;var D=(r,e)=>{for(var n in e)d(r,n,{get:e[n],enumerable:!0})},B=(r,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of R(e))!E.call(r,o)&&o!==n&&d(r,o,{get:()=>e[o],enumerable:!(t=w(e,o))||t.enumerable});return r};var A=(r,e,n)=>(n=r!=null?Q(N(r)):{},B(e||!r||!r.__esModule?d(n,"default",{value:r,enumerable:!0}):n,r)),T=r=>B(d({},"__esModule",{value:!0}),r);var P={};D(P,{SentryLink:()=>p,default:()=>p,excludeGraphQLFetch:()=>h,withoutGraphQLFetch:()=>k});module.exports=T(P);var f=require("@apollo/client/core"),S=A(require("zen-observable"));function c(r){return r.query.definitions.find(e=>e.kind==="OperationDefinition")}function O(r,e){let n=e.attachBreadcrumbs,t=c(r),o={},a=e.uri;a&&(o.url=a);let s=t.name?.value;return s&&(o.operationName=s),n.includeVariables&&(o.variables=r.variables),{type:"http",category:`graphql.${t.operation}`,data:o}}var y={shouldHandleOperation:void 0,uri:void 0,setSpan:!0,setFingerprint:!0,attachBreadcrumbs:{includeVariables:!1,includeError:!1,transform:void 0}};function x(r){return{...y,...r,attachBreadcrumbs:{...y.attachBreadcrumbs,...r.attachBreadcrumbs}}}var u=require("@sentry/browser");function g(r){let e={};for(let[n,t]of Object.entries(r))e[n]=typeof t=="object"?q(t):t;return e}function q(r){return JSON.stringify(r,null,2)}function L(r){let n=c(r).name;if(n){let o=(0,u.getCurrentHub)().getScope();if(!o)return;let a=o.getTransaction();return a?a.startChild({op:"apollo.request",description:"Apollo request: "+n.value}):void 0}}var C="{{ default }}";function F(r){let n=c(r).name;n&&(0,u.configureScope)(t=>{t.setFingerprint([C,n.value])})}function b(r,e,n){let t=n.attachBreadcrumbs&&typeof n.attachBreadcrumbs.transform=="function"?n.attachBreadcrumbs.transform(e,r):e;t.data=g(t.data),(0,u.addBreadcrumb)(t)}var p=class extends f.ApolloLink{options;constructor(e={}){super(),this.options=x(e)}request(e,n){let t=this.options;if(!(t.shouldHandleOperation?.(e)??!0))return n(e);let o;t.setSpan&&(o=L(e)),t.setFingerprint&&F(e);let a=t.attachBreadcrumbs,s=a?O(e,t):void 0;return new S.default(l=>{let v=n(e).subscribe({next:i=>{a&&(s.level=H(i),a.includeError&&i.errors&&i.errors.length>0&&(s.data.error=new f.ApolloError({graphQLErrors:i.errors}))),l.next(i)},complete:()=>{a&&b(e,s,t),t.setSpan&&o?.finish?.(),l.complete()},error:i=>{if(a){s.level="error";let m;if(j(i)){let{result:V,response:I,...G}=i;m=G}else m=i;a.includeError&&(s.data.error=m),b(e,s,t)}t.setSpan&&o?.finish?.(),l.error(i)}});return()=>{v.unsubscribe()}})}};function j(r){return typeof r=="object"&&r!==null&&"response"in r&&"result"in r&&"statusCode"in r}function H(r){return r.errors&&r.errors.length>0?"error":"info"}var h=r=>r.category==="fetch"&&(r.data?.url??"").includes("/ws.php")?null:r;function k(r){return(e,n)=>{let t=h(e,n);return t===null?null:r(t,n)}}
