"use strict";var Q=Object.create;var p=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var R=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,E=Object.prototype.hasOwnProperty;var D=(r,e)=>{for(var n in e)p(r,n,{get:e[n],enumerable:!0})},B=(r,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of R(e))!E.call(r,o)&&o!==n&&p(r,o,{get:()=>e[o],enumerable:!(t=w(e,o))||t.enumerable});return r};var A=(r,e,n)=>(n=r!=null?Q(N(r)):{},B(e||!r||!r.__esModule?p(n,"default",{value:r,enumerable:!0}):n,r)),T=r=>B(p({},"__esModule",{value:!0}),r);var P={};D(P,{SentryLink:()=>d,excludeGraphQLFetch:()=>h,withoutGraphQLFetch:()=>k});module.exports=T(P);var f=require("@apollo/client/core"),S=A(require("zen-observable"),1);function u(r){return r.query.definitions.find(e=>e.kind==="OperationDefinition")}function O(r,e){let n=e.attachBreadcrumbs,t=u(r),o={},i=e.uri;i&&(o.url=i);let s=t.name?.value;return s&&(o.operationName=s),n.includeVariables&&(o.variables=r.variables),{type:"http",category:`graphql.${t.operation}`,data:o}}var y={shouldHandleOperation:void 0,uri:void 0,setSpan:!0,setFingerprint:!0,attachBreadcrumbs:{includeVariables:!1,includeError:!1,transform:void 0}};function x(r){return{...y,...r,attachBreadcrumbs:{...y.attachBreadcrumbs,...r.attachBreadcrumbs}}}var c=require("@sentry/browser");function g(r){let e={};for(let[n,t]of Object.entries(r))e[n]=typeof t=="object"?q(t):t;return e}function q(r){return JSON.stringify(r,null,2)}function F(r){let n=u(r).name;if(n){let o=(0,c.getCurrentHub)().getScope();if(!o)return;let i=o.getTransaction();return i?i.startChild({op:"apollo.request",description:"Apollo request: "+n.value}):void 0}}var C="{{ default }}";function L(r){let n=u(r).name;n&&(0,c.configureScope)(t=>{t.setFingerprint([C,n.value])})}function b(r,e,n){let t=n.attachBreadcrumbs&&typeof n.attachBreadcrumbs.transform=="function"?n.attachBreadcrumbs.transform(e,r):e;t.data=g(t.data),(0,c.addBreadcrumb)(t)}var d=class extends f.ApolloLink{options;constructor(e={}){super(),this.options=x(e)}request(e,n){let t=this.options;if(!(t.shouldHandleOperation?.(e)??!0))return n(e);let o;t.setSpan&&(o=F(e)),t.setFingerprint&&L(e);let i=t.attachBreadcrumbs,s=i?O(e,t):void 0;return new S.default(l=>{let v=n(e).subscribe({next:a=>{i&&(s.level=H(a),i.includeError&&a.errors&&a.errors.length>0&&(s.data.error=new f.ApolloError({graphQLErrors:a.errors}))),l.next(a)},complete:()=>{i&&b(e,s,t),t.setSpan&&o?.finish?.(),l.complete()},error:a=>{if(i){s.level="error";let m;if(j(a)){let{result:V,response:I,...G}=a;m=G}else m=a;i.includeError&&(s.data.error=m),b(e,s,t)}t.setSpan&&o?.finish?.(),l.error(a)}});return()=>{v.unsubscribe()}})}};function j(r){return typeof r=="object"&&r!==null&&"response"in r&&"result"in r&&"statusCode"in r}function H(r){return r.errors&&r.errors.length>0?"error":"info"}var h=r=>r.category==="fetch"&&(r.data?.url??"").includes("/ws.php")?null:r;function k(r){return(e,n)=>{let t=h(e,n);return t===null?null:r(t,n)}}
